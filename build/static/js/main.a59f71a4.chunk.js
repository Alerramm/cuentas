(this.webpackJsonpcuentas=this.webpackJsonpcuentas||[]).push([[0],{188:function(e,t,a){e.exports=a(380)},193:function(e,t,a){},377:function(e,t,a){},380:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(4),i=a.n(o),c=(a(193),a(55)),l=a(56),s=a(61),u=a(57),d=a(62),m=a(382),p=a(135),g=a(9),f=function(){var e=m.a.Header;return r.a.createElement(e,{className:"header"},r.a.createElement("div",{className:"textHeader"},"CUENTAS POR COBRAR"))},h=a(386),b=a(383),v=a(99),y=a(387),k=a(385),E=a(23),D=a.n(E),w=a(46),C=function(){var e=Object(w.a)(D.a.mark((function e(t){var a,n,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.method,e.next=3,fetch(t.endpoint,{method:a});case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(w.a)(D.a.mark((function e(t){var a,n,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.method,e.next=3,fetch(t.endpoint,{method:a,body:JSON.stringify(t.data)});case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(w.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={endpoint:"http://www.misistema.mx/beluga/Finanzas/endpoints/cuentas/get/clientes.php",method:"GET"},e.abrupt("return",C(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(w.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={endpoint:"http://www.misistema.mx/beluga/Finanzas/endpoints/cuentas/get/facturas.php",method:"GET"},e.abrupt("return",C(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(w.a)(D.a.mark((function e(t){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={endpoint:"https://cors-anywhere.herokuapp.com/http://www.misistema.mx/beluga/Finanzas/endpoints/cuentas/put/abonar.php",method:"PUT",data:t},e.abrupt("return",F(a));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=m.a.Content,S=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={data:[],columns:[],loading:!1,id:0,parcial:!1,monto:0,tipo:"",btnAplicar:!0,idKey:""},a.searchData=function(e){var t;return a.state.data.map((function(a){return a.facturas.map((function(a){return e===a.key&&(t=a),!0})),!0})),t},a.updateData=function(e,t){var n=a.state.data;n.forEach((function(n){n.facturas.forEach((function(r){e===r.key&&(console.log(r),console.log(t),r.montoPorPagar=t.monto-t.montoPagado,r.estatus=a.estatus(parseInt(t.montoPagado,10),parseInt(t.monto,10),t.id,e),n.montoTotalPorPagar=n.montoTotalPorPagar-t.montoPagado)}))})),a.setState({data:n})},a.handleMenuClick=function(e){var t=e.key.substring(1+e.key.indexOf("-",e.key.indexOf("-",e.key.indexOf("-")+1)),e.key.length),n=a.searchData(t);console.log(a.searchData(t)),"pag"===e.key.substring(0,3)?a.setState({idKey:t,id:e.key.substring(4,e.key.indexOf("-",e.key.indexOf("-")+1)),monto:n.monto,tipo:"Pagada"},(function(){a.changeStatus()})):a.setState({idKey:t,id:e.key.substring(4,e.key.indexOf("-",e.key.indexOf("-")+1)),parcial:!0,tipo:"Parcial"})},a.changeStatus=function(){var e=a.state,t=e.id,n=e.monto,r=e.tipo,o=e.idKey;x({id:t,monto:n,tipoPago:r}).then((function(e){a.updateData(o,e.payload.payload[o.substring(1,o.length)])})),a.setState({parcial:!1,id:0,monto:0,tipo:""})},a.menu=function(e,t,n,o){var i=!1,c=!1;return n===t&&(i=!0),0!==n&&(c=!0),r.a.createElement(p.a,{onClick:a.handleMenuClick},r.a.createElement(p.a.Item,{disabled:i||c,key:"par-".concat(e,"-").concat(o)},"Parcial"),r.a.createElement(p.a.Item,{disabled:i,key:"pag-".concat(e,"-").concat(o)},"Pagada"))},a.expandedRowRender=function(e){var t=[{title:"Factura",dataIndex:"factura",key:"factura"},{title:"Viaje",dataIndex:"viaje",key:"viaje"},{title:"Monto Factura",dataIndex:"monto",key:"monto",render:function(e){return r.a.createElement(h.a,{value:e,disabled:!0,style:{width:"100%"},formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}},{title:"Monto por Cobrar",dataIndex:"montoPorPagar",key:"montoPorPagar",render:function(e){return r.a.createElement(h.a,{value:e,disabled:!0,style:{width:"100%"},formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}},{title:"Fecha",dataIndex:"fecha",key:"fecha"},{title:"Fecha Vencimiemto",dataIndex:"fechaVencimiento",key:"fechaVencimiento"},{title:"Estatus",dataIndex:"estatus",key:"estatus"}],n=a.state.data.filter((function(t){return t.cliente===e.cliente}));return r.a.createElement(b.a,{columns:t,dataSource:n[0].facturas,pagination:!1})},a.estatus=function(e,t,n,o){var i="Parcial",c="warning";return e>=t&&(i="Pagada",c="success"),0===e&&(i="Pendiente",c="error"),r.a.createElement(v.a,{overlay:a.menu(n,t,e,o)},r.a.createElement("div",null,i," ",r.a.createElement(y.a,{status:c})))},a.monthNames=["01","02","03","04","05","06","07","08","09","10","11","12"],a.comparar=function(e,t,a){return e>=t&&e<=a},a.llenarFacturas=function(e,t,n,r,o){var i=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),6,0,0)),c=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),6,0,0)),l=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),6,0,0)),s=new Date(Date.UTC(o.getFullYear(),o.getMonth(),o.getDate(),6,0,0)),u=a.state.data;e.payload.map((function(e,t){return u.map((function(n){if(n.cliente===e.cliente){var r=new Date;r.setFullYear(e.fecFacturacion.substring(0,4),parseInt(e.fecFacturacion.substring(5,7),10)-1,parseInt(e.fecFacturacion.substring(8,10),10)+parseInt(n.diasCredito,10)),n.montoTotalDeFacturas=Math.round(100*(n.montoTotalDeFacturas+e.monto))/100,n.montoTotalPorPagar=Math.round(100*(n.montoTotalPorPagar+e.monto-e.montoPagado))/100,n.numeroDeFacturasPorPagar=n.numeroDeFacturasPorPagar+1;var o=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),6,0,0));a.comparar(o,i,c)&&(n.semana1=Math.round(100*(n.semana1+e.monto))/100),a.comparar(o,l,s)&&(n.semana2=Math.round(100*(n.semana2+e.monto))/100),n.facturas.push({key:"F"+t,cliente:e.cliente,viaje:e.viaje,monto:e.monto,montoPorPagar:Math.round(100*(e.monto-e.montoPagado))/100,factura:e.factura,fecha:e.fecFacturacion.substring(8,10)+"-"+e.fecFacturacion.substring(5,7)+"-"+e.fecFacturacion.substring(0,4),fechaVencimiento:r.getDate()+"-"+a.monthNames[r.getMonth()]+"-"+r.getFullYear(),estatus:a.estatus(parseInt(e.montoPagado,10),parseInt(e.monto,10),e.id,"F"+t)})}return n})),e})),a.setState({data:u})},a.componentDidMount=function(){var e=a.state.data;a.setState({loading:!0});var t,n=new Date(Date.now());switch(n.getDay()){case 0:t=5,n.setDate(n.getDate()-7);break;case 1:t=4,n.setDate(n.getDate()-7);break;case 2:t=3,n.setDate(n.getDate()-7);break;case 3:t=2,n.setDate(n.getDate()-7);break;case 4:t=1,n.setDate(n.getDate()-7);break;case 5:t=0;break;case 6:t=-1;break;default:t=0}n.setDate(n.getDate()+t);var o=new Date(n);o.setDate(o.getDate()+6);var i=new Date(o);i.setDate(i.getDate()+1);var c=new Date(i);c.setDate(c.getDate()+6);var l=[{title:"CLIENTE",dataIndex:"cliente",key:"cliente"},{title:"# DE FACTURAS",dataIndex:"numeroDeFacturasPorPagar",key:"numeroDeFacturasPorPagar"},{title:"TOTAL DE FACTURAS",dataIndex:"montoTotalDeFacturas",key:"montoTotalDeFacturas",render:function(e){return r.a.createElement(h.a,{value:e,style:{width:"100%"},disabled:!0,formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}},{title:"TOTAL POR COBRAR",dataIndex:"montoTotalPorPagar",key:"montoTotalPorPagar",render:function(e){return r.a.createElement(h.a,{value:e,style:{width:"100%"},disabled:!0,formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}},{title:"SEMANA "+n.getDate()+"-"+a.monthNames[n.getMonth()]+"-"+n.getFullYear()+" / "+o.getDate()+"-"+a.monthNames[o.getMonth()]+"-"+o.getFullYear(),dataIndex:"semana1",key:"semana1",render:function(e){return r.a.createElement(h.a,{value:e,disabled:!0,style:{width:"100%"},formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}},{title:"SEMANA "+i.getDate()+"-"+a.monthNames[i.getMonth()]+"-"+i.getFullYear()+" / "+c.getDate()+"-"+a.monthNames[c.getMonth()]+"-"+c.getFullYear(),dataIndex:"semana2",key:"semana2",render:function(e){return r.a.createElement(h.a,{value:e,style:{width:"100%"},disabled:!0,formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}},{title:"DIAS DE CREDITO",dataIndex:"diasCredito",key:"diasCredito"}];P().then((function(t){t.payload.map((function(t,a){return e.push({key:"C"+a,cliente:t.nombre,numeroDeFacturasPorPagar:0,montoTotalDeFacturas:0,montoTotalPorPagar:0,semana1:0,semana2:0,diasCredito:t.diasCredito,facturas:[]}),t})),a.setState({data:e})})),O().then((function(e){a.llenarFacturas(e,n,o,i,c)})),a.setState({columns:l,loading:!1})},a.handleChange=function(e){a.setState({monto:e},(function(){var e=a.state.monto;a.setState({btnAplicar:0===e})}))},a.handleCancel=function(){a.setState({parcial:!1,id:0,monto:0,btnAplicar:!0})},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.data,a=e.columns,o=e.loading,i=e.parcial,c=e.monto,l=e.btnAplicar;return r.a.createElement(n.Fragment,null,r.a.createElement(A,null,r.a.createElement(m.a,{style:{padding:"24px 24px",background:"#fff"}},r.a.createElement(b.a,{className:"components-table-demo-nested",columns:a,dataSource:t,loading:o,expandedRowRender:this.expandedRowRender,bordered:!0,pagination:{position:"top"}}))),i&&r.a.createElement(k.a,{title:"Importe",visible:i,onOk:this.changeStatus,onCancel:this.handleCancel,closable:!1,maskClosable:!1,okButtonProps:{disabled:l}},r.a.createElement(h.a,{autoFocus:!0,value:c,min:0,onChange:this.handleChange})))}}]),t}(n.Component),I=a(60),T=a(384),j={labels:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],datasets:[{label:"Ventas",backgroundColor:"rgba(156, 242, 110, 0.84)",borderColor:"rgba(88, 215, 20, 1)",borderWidth:2,hoverBackgroundColor:"rgba(88, 215, 20, 1)",hoverBorderColor:"rgba(88, 215, 20, 1)",data:[200526,251e3,19e4,3e5,201e3,195e3,21e4,25e4,198e3,205e3,183e3,186e3]}]},B=function(){return r.a.createElement(T.a,{title:"Ventas 2019",bordered:!1},r.a.createElement(I.a,{data:j,height:100,options:{maintainAspectRatio:!0}}))},M={labels:["AQUAPRIMA","BACARDI","DILTEX"],datasets:[{data:[300,50,100],backgroundColor:["#FF6384","#36A2EB","#FFCE56"],hoverBackgroundColor:["#FF6384","#36A2EB","#FFCE56"]}]},R=function(){return r.a.createElement(T.a,{title:"Clientes",bordered:!1},r.a.createElement(I.b,{data:M,height:100}))},N={labels:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],datasets:[{label:"Cobrado",fill:!1,lineTension:.1,backgroundColor:"rgba(166, 166, 166, 0.81)",borderColor:"rgba(0, 0, 0, 0.81)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(0, 0, 0, 0.81)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(59, 59, 59, 0.81)",pointHoverBorderColor:"rgba(59, 59, 59, 0.81)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[195e3,23e4,15e4,25e4,201e3,11e4,2e5,26e4,2e5,204e3,183e3,2e5]},{label:"Vendido",fill:!1,lineTension:.1,backgroundColor:"rgba(255, 0, 0, 0.62)",borderColor:"rgba(255, 0, 0, 0.78)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(255, 0, 0, 1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(255, 0, 0, 1)",pointHoverBorderColor:"rgba(255, 0, 0, 1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[200526,251e3,19e4,3e5,201e3,195e3,21e4,25e4,198e3,205e3,183e3,186e3]}]},W=function(){return r.a.createElement(T.a,{title:"Cobranza 2019",bordered:!1},r.a.createElement(I.c,{data:N,height:50,weight:300}))},U=a(66),H=a(28),Y=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(U.a,null,r.a.createElement(H.a,{span:12},r.a.createElement(B,null)),r.a.createElement(H.a,{span:12},r.a.createElement(R,null))),r.a.createElement(U.a,null,r.a.createElement(H.a,{span:24},r.a.createElement(W,null))))}}]),t}(n.Component),J=(a(377),a(378),m.a.Sider),V=m.a.Content,z=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={collapsed:!0,opcion:"tabla"},a.toggle=function(){a.setState({collapsed:!a.state.collapsed})},a.option=function(e){a.setState({opcion:e.item.props.name})},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.opcion;return r.a.createElement(m.a,{style:{position:"fixed",zIndex:1,width:"100%",height:"100%"}},r.a.createElement(J,{trigger:null,collapsible:!0,collapsed:this.state.collapsed},r.a.createElement(p.a,{theme:"dark",mode:"inline",defaultSelectedKeys:["1"]},r.a.createElement("div",{className:"collapse",onClick:this.toggle},r.a.createElement(g.a,{className:"trigger",type:this.state.collapsed?"menu-unfold":"menu-fold"})),r.a.createElement(p.a.Item,{key:"1",name:"tabla",onClick:this.option},r.a.createElement(g.a,{type:"table"}),r.a.createElement("span",null,"Control")),r.a.createElement(p.a.Item,{key:"2",name:"analitycs",onClick:this.option},r.a.createElement(g.a,{type:"bar-chart"}),r.a.createElement("span",null,"Analitycs")),r.a.createElement(p.a.Item,{key:"3",name:"upload",onClick:this.option},r.a.createElement(g.a,{type:"upload"}),r.a.createElement("span",null,"Agregar Facturas")))),r.a.createElement(m.a,null,r.a.createElement(f,null),r.a.createElement(V,null,"tabla"===e&&r.a.createElement(S,null),"analitycs"===e&&r.a.createElement(Y,null))))}}]),t}(n.Component),L=a(183),K=a(37),G=a(181),Q=a(182),X=Object(K.combineReducers)({});var $=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function q(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Z=function(){var e=K.applyMiddleware.apply(void 0,[Q.a].concat([])),t=Object(G.composeWithDevTools)(e);return Object(K.createStore)(X,{},t)}();i.a.render(r.a.createElement(L.a,{store:Z},r.a.createElement(z,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/Alerramm/cuentas.git",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/Alerramm/cuentas.git","/service-worker.js");$?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):q(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):q(t,e)}))}}()}},[[188,1,2]]]);
//# sourceMappingURL=main.a59f71a4.chunk.js.map